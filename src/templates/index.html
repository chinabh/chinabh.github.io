<!DOCTYPE html>
<html lang="{{LANG}}" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>{{META_TITLE}}</title>
    <meta name="description" content="{{META_DESCRIPTION}}">
    <meta name="keywords" content="{{META_KEYWORDS}}">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{META_TITLE}}">
    <meta property="og:description" content="{{META_DESCRIPTION}}">
    <meta property="og:image" content="{{OG_IMAGE}}">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Styles -->
    <link rel="stylesheet" href="/assets/styles.css">

    <!-- Fonts - Self-hosted for China compatibility -->
    <style>
        /* Critical CSS for fast first paint */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Sans CJI SC"; line-height: 1.6; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    </style>
</head>
<body>
    <!-- Floating Header -->
    <header class="floating-header" id="floating-header">
        <div class="header-container">
            <a href="#hero" class="header-logo">
                <img src="{{HEADER_LOGO}}" alt="{{HEADER_LOGO_ALT}}" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';" />
                <span style="display:none; font-size:1.2rem; font-weight:bold; color:#dc2626;">China Business Hub</span>
            </a>
            <nav class="header-nav">
                {{HEADER_BUTTONS}}
                <div class="lang-switcher">
                    <select id="language-selector" onchange="switchLanguage(this.value)">
                        {{LANGUAGE_OPTIONS}}
                    </select>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="hero" class="hero" style="background-image: url('{{HERO_BG_IMAGE}}');">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <h1 class="hero-title">{{HERO_TITLE}}</h1>
            <p class="hero-subtitle">{{HERO_SUBTITLE}}</p>

            <div class="hero-cta">
                <button class="btn btn-primary" onclick="scrollToSection('contact')">{{HERO_CTA_PRIMARY}}</button>
                <button class="btn btn-secondary" onclick="scrollToSection('process')">{{HERO_CTA_SECONDARY}}</button>
            </div>

            <div class="trust-badges">
                {{TRUST_BADGES}}
            </div>

            {{CANTON_BANNER}}
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about section">
        <div class="container">
            <h2 class="section-title">{{ABOUT_TITLE}}</h2>

            <div class="about-grid">
                <div class="about-card">
                    <h3>{{MISSION_TITLE}}</h3>
                    <p>{{MISSION_CONTENT}}</p>
                </div>

                <div class="about-card">
                    <h3>{{VISION_TITLE}}</h3>
                    <p>{{VISION_CONTENT}}</p>
                </div>
            </div>

            {{GUANXI_SECTION}}
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="services section section-alt">
        <div class="container">
            <h2 class="section-title">{{SERVICES_TITLE}}</h2>

            <div class="services-grid">
                {{SERVICES_ITEMS}}
            </div>
        </div>
    </section>

    <!-- Process Section -->
    <section id="process" class="process section">
        <div class="container">
            <h2 class="section-title">{{PROCESS_TITLE}}</h2>

            <div class="process-steps">
                {{PROCESS_STEPS}}
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact section section-alt">
        <div class="container">
            <h2 class="section-title">{{CONTACT_TITLE}}</h2>
            <p class="section-subtitle">{{CONTACT_SUBTITLE}}</p>

            <div class="contact-wrapper">
                <!-- Contact Form -->
                <div class="contact-form-container">
                    <form id="contact-form" class="contact-form" action="{{FORM_ACTION}}" method="{{FORM_METHOD}}" onsubmit="return handleFormSubmit(event)">
                        {{FORM_FIELDS}}

                        <!-- Hidden fields for tracking -->
                        <input type="hidden" name="language" value="{{LANG}}">
                        <input type="hidden" name="_subject" value="New Contact from China Business Hub ({{LANG_NAME}})">
                        <input type="hidden" name="_page_url" id="_page_url">
                        <input type="hidden" name="_user_agent" id="_user_agent">

                        <!-- Honeypot for spam protection -->
                        <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off">

                        <button type="submit" class="btn btn-primary btn-block" id="submit-btn">
                            {{FORM_SUBMIT_TEXT}}
                        </button>
                    </form>

                    <!-- Success/Error Messages -->
                    <div id="form-success" class="alert alert-success" style="display:none;">
                        {{SUCCESS_MESSAGE}}
                    </div>
                    <div id="form-error" class="alert alert-error" style="display:none;">
                        {{ERROR_MESSAGE}}
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="contact-info">
                    <div class="contact-methods">
                        {{CONTACT_METHODS}}
                    </div>

                    {{WECHAT_QR}}
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                {{FOOTER_LINKS}}
            </div>
            <div class="footer-copyright">
                {{FOOTER_COPYRIGHT}}
            </div>
        </div>
    </footer>

    {{WHATSAPP_BUTTON}}

    <!-- Scripts -->
    <script>
        // Set tracking fields
        document.getElementById('_page_url').value = window.location.href;
        document.getElementById('_user_agent').value = navigator.userAgent;

        // Add UTM parameters if present
        const urlParams = new URLSearchParams(window.location.search);
        ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content'].forEach(param => {
            if (urlParams.has(param)) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = param;
                input.value = urlParams.get(param);
                document.getElementById('contact-form').appendChild(input);
            }
        });

        // Smooth scroll
        function scrollToSection(id) {
            const element = document.getElementById(id.replace('#', ''));
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Language switcher
        function switchLanguage(lang) {
            const currentPath = window.location.pathname;
            let newPath = '/';

            if (lang === 'en') newPath = '/';
            else if (lang === 'zh') newPath = '/zh/';

            window.location.href = newPath;
        }

        // Form validation and submission
        function handleFormSubmit(event) {
            const form = event.target;
            const submitBtn = document.getElementById('submit-btn');
            const successMsg = document.getElementById('form-success');
            const errorMsg = document.getElementById('form-error');

            // Clear previous messages
            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';

            // Validate required fields
            let isValid = true;
            const requiredFields = form.querySelectorAll('[required]');

            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.style.borderColor = '#dc2626';
                    isValid = false;
                } else {
                    field.style.borderColor = '#d1d5db';
                }
            });

            if (!isValid) {
                errorMsg.textContent = '{{ERROR_MESSAGE}}';
                errorMsg.style.display = 'block';
                return false;
            }

            // Show loading state
            submitBtn.disabled = true;
            submitBtn.textContent = '{{LOADING_TEXT}}';

            // If using FormSubmit or similar, let form submit naturally
            // Otherwise, handle with fetch API
            return true; // Allow form submission
        }

        // Show success message after redirect (if using FormSubmit)
        if (window.location.search.includes('submitted=true')) {
            document.getElementById('form-success').style.display = 'block';
            document.getElementById('contact-form').style.display = 'none';
        }
    </script>

    <script src="/assets/form-handler.js"></script>
</body>
</html>
